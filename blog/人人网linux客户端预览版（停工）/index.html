
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>人人网Linux客户端预览版（停工） - 人間夜行</title>
  <meta name="author" content="人間夜行">

  
  <meta name="description" content="想必大家一定还记得，我写过两个和人人网有关的脚本。一个是利用bash、w3m和wget制作的《人人网LINUX准客户端脚本》，主要功能为终端下的消息提醒和快速访问。（终端响铃很NB吧？）另一个则是其前身《人人消息提醒》，功能也不算完备，而且还需自行处理cookie。 现在看来， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://koccn.net/blog/%E4%BA%BA%E4%BA%BA%E7%BD%91linux%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%A2%84%E8%A7%88%E7%89%88%EF%BC%88%E5%81%9C%E5%B7%A5%EF%BC%89">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="人間夜行" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='https://fonts.lug.ustc.edu.cn/css?family=Noto+Serif:400,700' rel='stylesheet' type='text/css'>
<link href='https://fonts.lug.ustc.edu.cn/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">人間夜行</a></h1>
  
    <h2>一切の有為の法　夢幻泡影の如し</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  
  
</ul>

<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">人人网Linux客户端预览版（停工）</h1>
    
    
      <p class="meta">
        








  



<time datetime="2014-08-17T00:00:00+08:00" pubdate data-updated="true">Aug 17th, 2014</time>
        
        
           | <a href="#comments">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>想必大家一定还记得，我写过两个和人人网有关的脚本。一个是利用bash、w3m和wget制作的<a title="人人网Linux准客户端脚本" href="http://koccn.net/wordpress/%e4%ba%ba%e4%ba%ba%e7%bd%91linux%e5%87%86%e5%ae%a2%e6%88%b7%e7%ab%af%e8%84%9a%e6%9c%ac/" target="_blank">《人人网LINUX准客户端脚本》</a>，主要功能为终端下的消息提醒和快速访问。（终端响铃很NB吧？）另一个则是其前身<a title="人人消息提醒" href="http://koccn.net/wordpress/%e4%ba%ba%e4%ba%ba%e6%b6%88%e6%81%af%e6%8f%90%e9%86%92/" target="_blank">《人人消息提醒》</a>，功能也不算完备，而且还需自行处理cookie。</p>

<p><!--more--></p>

<p>现在看来，这种玩弄网页的方式实在是不稳定，万一人人改版，那就几乎要重写一个了。随着知识水平的提高，我也能够不断尝试新的方法。既然人人已经提供了api，那就干脆用一下好了。</p>

<p>在这里不得不再吐槽人人一下。其python版本的sdk简直不忍直视，而且万年无人更新。新版本的api干脆就没有python的sdk了。果然我小众群体是不被关注的。没办法，只能自力更生，从头写起。本人精力有限，仅试图实现了有限的功能（发状态和回复，无提醒），供大家参考。代码质量什么的就不要吐槽了。
<h2>程序说明</h2>
本程序由python3写成，使用了selenium控制浏览器（主要是为了获取各种token，已经假设你使用firefox），easygui提供图形界面和pil显示图片。使用前除了标准库之外，需要将这些库安装到位。安装方法请自行搜索。</p>

<p>程序分三部分。freerr.py主要管理登陆和基本流程控制，也是用户直接运行的main部分。它能在主目录下创建配置文件夹以保存access_token、用户id和图片缓存。renrenobj.py则发挥了一个劣质sdk的作用。freerr.php放在你的服务器端以获取各种token并被本地读取。不要问我为什么需要这个文件，去问人人oauth机制为什么一定要是这样的。总之这样可以把secret_key保护好。</p>

<p>本人尝试了把客户端提交给人人，可是被退回了，理由是不能安装（是你不会用吧？为什么不看README？）。所以，本程序就不能作为第三方应用的制成品发布了。可以说这篇文章是面向开发者的（为什么现在才说！？）。各位试用时需要先获得人人开放平台的应用api_key和secret_key，修改好php文件后放在自己服务器上，然后改好本地文件的redirect_url和api_key之后方能使用。需要改的内容大多在字符串中，周围的注释有五个感叹号（=_=!），大家仔细寻找，不要漏掉。
<h2>代码</h2>
<h3>freerr.py</h3>
<pre class="brush:python">#!/usr/bin/env python3
# -*- coding:utf-8 -*-
'''freerr.py</pre></p>

<p>This is an attempt to make a client for Renren on Linux using Python3.<br />
Author: Tianhu Zhang &lt;zszth@126.com&gt; (A beginner to Python3)<br />
renren.py is the main file which includes the very basic auth work.<br />
And all the editable constants are listed in this file for convenience.<br />
More useful classes are in renrenobj.py and should be imported before use.<br />
&#8221;&#8217;<br />
from selenium import webdriver<br />
from selenium.webdriver.common.keys import Keys<br />
import urllib.request<br />
import json<br />
import renrenobj<br />
import os<br />
# import getpass<br />
import easygui as g<br />
# import glob<br />
import webbrowser</p>

<p>REFRESH_TOKEN = &#8221;<br />
ACCESS_TOKEN = &#8221;<br />
USER_ID = 0</p>

<p>if os.path.isfile(os.path.join(os.path.expanduser(&#8216;~/.freerr&#8217;), &#8216;.freerr&#8217;)):<br />
    with open(os.path.join(os.path.expanduser(&#8216;~/.freerr&#8217;), &#8216;.freerr&#8217;), mode=&#8217;r&#8217;, encoding=&#8217;UTF-8&#8217;) as conf_file:<br />
        ACCESS_TOKEN = conf_file.readline()<br />
        USER_ID = int(conf_file.readline())<br />
else:<br />
    # user_email = input(&#8216;Input Email to login: &gt;&#8217;)<br />
    # user_password = getpass.unix_getpass(&#8216;Input password: &gt;&#8217;)<br />
    user_email = g.enterbox(&#8216;Input Email to login:&#8217;, &#8216;Login&#8217;)<br />
    user_password = g.passwordbox(&#8216;Input password:&#8217;, &#8216;Login&#8217;)<br />
    browser = webdriver.Firefox()<br />
    #！！！！！以下修改两处。client_id后面加上api_key，redirect_uri后加上php文件的url。<br />
    browser.get(<br />
        &#8216;https://graph.renren.com/oauth/authorize?client_id=&amp;redirect_uri=&amp;response_type=code&#8217;)<br />
    username = browser.find_element_by_name(&#8216;username&#8217;)<br />
    username.send_keys(user_email)<br />
    password = browser.find_element_by_name(&#8216;password&#8217;)<br />
    password.send_keys(user_password)<br />
    password.send_keys(Keys.ENTER)<br />
    json_inputbox = browser.find_element_by_tag_name(&#8216;textarea&#8217;)<br />
    a_t_data = json.loads(json_inputbox.text, encoding=&#8217;UTF-8&#8217;)<br />
    browser.close()<br />
    # REFRESH_TOKEN = a_t_data[&#8216;refresh_token&#8217;]<br />
    ACCESS_TOKEN = a_t_data[&#8216;access_token&#8217;]<br />
    USER_ID = a_t_data[&#8216;user&#8217;][&#8216;id&#8217;]<br />
    os.mkdir(os.path.expanduser(&#8216;~/.freerr&#8217;))<br />
    with open(os.path.join(os.path.expanduser(&#8216;~/.freerr&#8217;), &#8216;.freerr&#8217;), mode=&#8217;w&#8217;, encoding=&#8217;utf-8&#8217;) as conf_file:<br />
        conf_file.writelines(ACCESS_TOKEN + &#8216;\n&#8217;)<br />
        conf_file.writelines(str(USER_ID))<br />
renrenobj.A_T = ACCESS_TOKEN<br />
renrenobj.USER_ID = USER_ID</p>

<p>f = renrenobj.Feed()</p>

<p>flag_exit = False<br />
i = 0<br />
while not flag_exit:<br />
    if f.feed_list[i][&#8216;attachment&#8217;] and f.feed_list[i][&#8216;attachment&#8217;][0][&#8216;orginalUrl&#8217;]:<br />
        if not os.path.isfile(<br />
                os.path.join(os.path.expanduser(&#8216;~/.freerr&#8217;), &#8216;.freerr_&#8217; + str(f.feed_list[i][&#8216;resource&#8217;][&#8216;id&#8217;]))):<br />
            img_data = urllib.request.urlopen(f.feed_list[i][&#8216;attachment&#8217;][0][&#8216;orginalUrl&#8217;]).read()<br />
            with open(os.path.join(os.path.expanduser(&#8216;~/.freerr&#8217;), &#8216;.freerr_&#8217; + str(f.feed_list[i][&#8216;resource&#8217;][&#8216;id&#8217;])),<br />
                      mode=&#8217;wb&#8217;) as img_file:<br />
                img_file.write(img_data)<br />
        choice = g.buttonbox(&#8216;{0} {1} {2}\n    {3}\n    source: {4}\n            {5}&#8217;.format(i, f.feed_list[i][&#8216;time&#8217;],<br />
                                                                                             f.feed_list[i][<br />
                                                                                                 &#8216;sourceUser&#8217;][<br />
                                                                                                 &#8216;name&#8217;],<br />
                                                                                             f.feed_list[i][&#8216;message&#8217;],<br />
                                                                                             f.feed_list[i][&#8216;resource&#8217;][<br />
                                                                                                 &#8216;title&#8217;],<br />
                                                                                             f.feed_list[i][&#8216;resource&#8217;][<br />
                                                                                                 &#8216;content&#8217;]),<br />
                             &#8216;Feed List &#8217; + str(i),<br />
                             [&#8216;Next&#8217;, &#8216;Comment&#8217;, &#8216;Open Browser&#8217;, &#8216;Update Status&#8217;, &#8216;Refresh&#8217;, &#8216;Exit&#8217;, &#8216;Prev&#8217;],<br />
                             image=os.path.join(os.path.expanduser(&#8216;~/.freerr&#8217;),<br />
                                                &#8216;.freerr_&#8217; + str(f.feed_list[i][&#8216;resource&#8217;][&#8216;id&#8217;])))<br />
    else:<br />
        choice = g.buttonbox(&#8216;{0} {1} {2}\n    {3}\n    source: {4}\n            {5}&#8217;.format(i, f.feed_list[i][&#8216;time&#8217;],<br />
                                                                                             f.feed_list[i][<br />
                                                                                                 &#8216;sourceUser&#8217;][<br />
                                                                                                 &#8216;name&#8217;],<br />
                                                                                             f.feed_list[i][&#8216;message&#8217;],<br />
                                                                                             f.feed_list[i][&#8216;resource&#8217;][<br />
                                                                                                 &#8216;title&#8217;],<br />
                                                                                             f.feed_list[i][&#8216;resource&#8217;][<br />
                                                                                                 &#8216;content&#8217;]),<br />
                             &#8216;Feed List &#8217; + str(i),<br />
                             [&#8216;Next&#8217;, &#8216;Comment&#8217;, &#8216;Update Status&#8217;, &#8216;Refresh&#8217;, &#8216;Exit&#8217;, &#8216;Prev&#8217;])<br />
    if choice == &#8216;Prev&#8217;:<br />
        if i == 0:<br />
            g.msgbox(&#8216;No Prev!&#8217;, &#8216;Error&#8217;)<br />
        else:<br />
            i = i - 1<br />
    elif choice == &#8216;Exit&#8217;:<br />
        flag_exit = True<br />
    elif choice == &#8216;Next&#8217;:<br />
        if i == len(f.feed_list) - 1:<br />
            g.msgbox(&#8216;No Next!&#8217;, &#8216;Error&#8217;)<br />
        else:<br />
            i = i + 1<br />
    elif choice == &#8216;Comment&#8217;:<br />
        c = renrenobj.Comment(f.feed_list[i][&#8216;type&#8217;], f.feed_list[i][&#8216;sourceUser&#8217;][&#8216;id&#8217;],<br />
                              f.feed_list[i][&#8216;resource&#8217;][&#8216;id&#8217;])<br />
        cl = []<br />
        for j in range(len(c.comment_list)):<br />
            cl.append(&#8216;{0} {1} {2}\n    {3}&#8217;.format(j, c.comment_list[j][&#8216;time&#8217;],<br />
                                                    renrenobj.User.get_user_name(renrenobj.User,<br />
                                                                                 c.comment_list[j][&#8216;authorId&#8217;]),<br />
                                                    c.comment_list[j][&#8216;content&#8217;]))<br />
        cl.append(&#8216;-1 Make a comment without replying to anyone&#8217;)<br />
        reply_choice = g.choicebox(&#8216;Choose a person to reply:&#8217;, &#8216;Comments List&#8217;, cl)<br />
        if reply_choice:<br />
            c.make_comment(int(reply_choice.split(&#8217; &#8216;)[0]))<br />
    elif choice == &#8216;Update Status&#8217;:<br />
        renrenobj.status_pub()<br />
    elif choice == &#8216;Refresh&#8217;:<br />
        del f<br />
        f = renrenobj.Feed()<br />
        i = 0<br />
    elif choice == &#8216;Open Browser&#8217;:<br />
        webbrowser.open(f.feed_list[i][&#8216;attachment&#8217;][0][&#8216;url&#8217;])
<h3> renrenobj.py</h3>
<pre class="brush:python">#!/usr/bin/env python3
# -*- coding:utf-8 -*-
'''renrenobj.py</pre></p>

<p>Renren defines a lot of special types.<br />
This is a library of types returned in JSON.<br />
&#8221;&#8217;<br />
import json<br />
import urllib.request<br />
import urllib.parse<br />
import easygui as g</p>

<p>A_T = &#8221;<br />
USER_ID = 0</p>

<p>def get_json_get(url_in):<br />
    &#8221;&#8217;Function get_json_get<br />
    GET mode.<br />
    This returns an object loaded from json.<br />
    When error return None.<br />
    Make sure the end of url_in and the beginning of a_t are correct.<br />
    If url_in is with a parameter, add a &#8216;&amp;&#8217; after it.<br />
    &#8221;&#8217;<br />
    data = urllib.request.urlopen(url_in + &#8216;access_token=&#8217; + A_T).read()<br />
    json_data = data.decode(&#8216;UTF-8&#8217;)<br />
    obj = json.loads(json_data, encoding=&#8217;UTF-8&#8217;)<br />
    if &#8216;error&#8217; in obj:<br />
        g.msgbox(str(obj), &#8216;Error&#8217;)<br />
        return None<br />
    else:<br />
        return obj[&#8216;response&#8217;]</p>

<p>def get_json_post(url_in, para):<br />
    &#8221;&#8217;Function get_json_post<br />
    POST mode.<br />
    para should be a dict.<br />
    This returns an object loaded from json.<br />
    When error return None.<br />
    Make sure the end of url_no_a_t and the beginning of a_t are correct.<br />
    &#8221;&#8217;<br />
    postdata = urllib.parse.urlencode(para).encode(encoding=&#8217;UTF-8&#8217;)<br />
    json_data = urllib.request.urlopen(url_in + &#8216;access_token=&#8217; + A_T, postdata).read().decode(&#8216;UTF-8&#8217;)<br />
    obj = json.loads(json_data, encoding=&#8217;UTF-8&#8217;)<br />
    if &#8216;error&#8217; in obj:<br />
        g.msgbox(str(obj), &#8216;Error&#8217;)<br />
        return None<br />
    else:<br />
        return obj[&#8216;response&#8217;]</p>

<p>class Feed:<br />
    &#8221;&#8217;Class Feed</p>

<p>    This deals with the feed list.<br />
    a_t should be passed in when init.<br />
    &#8221;&#8217;<br />
    URL_GET_FEED_LIST = &#8216;https://api.renren.com/v2/feed/list?&#8217;</p>

<p>    def __init__(self):<br />
        self.feed_list = get_json_get(self.URL_GET_FEED_LIST)<br />
        if self.feed_list:<br />
            self.feed_list = list(self.feed_list)<br />
            # If the list is None then do nothing.<br />
            # Abandoned.<br />
            # if self.feed_list:<br />
            # for feed in self.feed_list[&#8216;response&#8217;]:<br />
            # self.simplist.append(<br />
            #             {&#8216;id&#8217;: feed[&#8216;id&#8217;], &#8216;time&#8217;: feed[&#8216;time&#8217;], &#8216;resource_content&#8217;: feed[&#8216;resource&#8217;][&#8216;content&#8217;],<br />
            #              &#8216;user&#8217;: feed[&#8216;sourceUser&#8217;][&#8216;name&#8217;], &#8216;message&#8217;: feed[&#8216;message&#8217;],<br />
            #              &#8216;resource_title&#8217;: feed[&#8216;resource&#8217;][&#8216;title&#8217;], &#8216;resource_id&#8217;: feed[&#8216;resource&#8217;][&#8216;id&#8217;], &#8216;type&#8217;: feed[&#8216;type&#8217;], &#8216;user_id&#8217;: feed[&#8216;sourceUser&#8217;][&#8216;id&#8217;],})</p>

<p>    def show_feed_list(self):<br />
        for i in range(len(self.feed_list)):<br />
            print(&#8216;{0} {1} {2}\n    {3}\n    source: {4}\n            {5}&#8217;.format(i, self.feed_list[i][&#8216;time&#8217;],<br />
                                                                                  self.feed_list[i][&#8216;sourceUser&#8217;][<br />
                                                                                      &#8216;name&#8217;],<br />
                                                                                  self.feed_list[i][&#8216;message&#8217;],<br />
                                                                                  self.feed_list[i][&#8216;resource&#8217;][<br />
                                                                                      &#8216;title&#8217;],<br />
                                                                                  self.feed_list[i][&#8216;resource&#8217;][<br />
                                                                                      &#8216;content&#8217;]),<br />
                  end=&#8217;\n\n\n&#8217;)</p>

<p>    def show_comment(self):<br />
        i = int(input(&#8216;Input id to enter: &gt;&#8217;))<br />
        c = Comment(self.feed_list[i][&#8216;type&#8217;],<br />
                    self.feed_list[i][&#8216;sourceUser&#8217;][&#8216;id&#8217;],<br />
                    self.feed_list[i][&#8216;resource&#8217;][&#8216;id&#8217;])<br />
        cl = c.comment_list<br />
        print(&#8216;|{0} {1} {2}\n|    {3}\n|    source: {4}\n|            {5}&#8217;.format(i, self.feed_list[i][&#8216;time&#8217;],<br />
                                                                                  self.feed_list[i][&#8216;sourceUser&#8217;][<br />
                                                                                      &#8216;name&#8217;],<br />
                                                                                  self.feed_list[i][&#8216;message&#8217;],<br />
                                                                                  self.feed_list[i][&#8216;resource&#8217;][<br />
                                                                                      &#8216;title&#8217;],<br />
                                                                                  self.feed_list[i][&#8216;resource&#8217;][<br />
                                                                                      &#8216;content&#8217;]),<br />
              end=&#8217;\n\n\n&#8217;)<br />
        for j in range(len(cl)):<br />
            print(&#8216;{0} {1} {2}\n    {3}&#8217;.format(j, cl[j][&#8216;time&#8217;], User.get_user_name(User, cl[j][&#8216;authorId&#8217;]),<br />
                                                cl[j][&#8216;content&#8217;]), end=&#8217;\n\n&#8217;)<br />
            # ctrl = int(input(&#8216;Input a positive number to comment: &gt;&#8217;))<br />
            # if ctrl &gt; 0:<br />
            # c.make_comment()</p>

<p>class Comment:<br />
    URL_GET_COMMENT_LIST = &#8216;https://api.renren.com/v2/comment/list?&#8217;</p>

<p>    def __init__(self, commentType, entryOwnerId, entryId):<br />
        &#8221;&#8217;Function __init__</p>

<p>        entryId should be resource id.<br />
        &#8221;&#8217;<br />
        self.entryOwnerId = entryOwnerId<br />
        self.entryId = entryId<br />
        if &#8216;SHARE&#8217; in commentType:<br />
            self.commentType = &#8216;SHARE&#8217;<br />
        if &#8216;UPDATE&#8217; in commentType:<br />
            self.commentType = commentType[7:]<br />
        para = &#8216;commentType={0}&amp;entryOwnerId={1}&amp;entryId={2}&amp;&#8217;.format(self.commentType, self.entryOwnerId, self.entryId)<br />
        self.comment_list = get_json_get(self.URL_GET_COMMENT_LIST + para)<br />
        if self.comment_list:<br />
            self.comment_list = list(self.comment_list)</p>

<p>    def make_comment(self, i):<br />
        URL_MAKE_COMMENT = &#8216;https://api.renren.com/v2/comment/put?&#8217;<br />
        # i = int(input(&#8216;Input id to send to,\nNegative number not to specify: &gt;&#8217;))<br />
        if i &gt;= 0 and self.comment_list[i][&#8216;authorId&#8217;] == USER_ID:<br />
            g.msgbox(&#8216;Cannot reply to yourself!&#8217;, &#8216;Error&#8217;)<br />
            return<br />
        text = g.enterbox(&#8216;Input the content:&#8217;, &#8216;Comment&#8217;)<br />
        if text:<br />
            if i &lt; 0:<br />
                para = {&#8216;content&#8217;: text,<br />
                        &#8216;commentType&#8217;: self.commentType,<br />
                        &#8216;entryOwnerId&#8217;: self.entryOwnerId,<br />
                        &#8216;entryId&#8217;: self.entryId}<br />
                obj = get_json_post(URL_MAKE_COMMENT, para)<br />
                if obj:<br />
                    g.msgbox(&#8216;Done.&#8217;, &#8216;Comment&#8217;)<br />
            else:<br />
                para = {&#8216;content&#8217;: text,<br />
                        &#8216;commentType&#8217;: self.commentType,<br />
                        &#8216;entryOwnerId&#8217;: self.entryOwnerId,<br />
                        &#8216;entryId&#8217;: self.entryId,<br />
                        &#8216;targetUserId&#8217;: self.comment_list[i][&#8216;authorId&#8217;]}<br />
                obj = get_json_post(URL_MAKE_COMMENT, para)<br />
                if obj:<br />
                    g.msgbox(&#8216;Done.&#8217;, &#8216;Comment&#8217;)</p>

<p>def status_pub():<br />
    text = g.enterbox(&#8216;Input status:&#8217;, &#8216;Update Status&#8217;)<br />
    if text:<br />
        URL_STATUS_PUB = &#8216;https://api.renren.com/v2/status/put?&#8217;<br />
        obj = get_json_post(URL_STATUS_PUB, {&#8216;content&#8217;: text})<br />
        if obj:<br />
            g.msgbox(&#8216;Done.&#8217;, &#8216;Update Status&#8217;)</p>

<p>class User:<br />
    &#8221;&#8217;Class User</p>

<p>    This deals with user info.<br />
    &#8221;&#8217;<br />
    user_id = 0<br />
    user_name = &#8221;</p>

<p>    def __init__(self, user_id):<br />
        self.user_id = user_id</p>

<p>    def get_user_name(self, user_id):<br />
        URL_GET_USER_NAME = &#8216;https://api.renren.com/v2/user/get?&#8217;<br />
        obj = get_json_get(URL_GET_USER_NAME + &#8216;userId={0}&#8217;.format(user_id) + &#8216;&amp;&#8217;)<br />
        if obj:<br />
            self.user_name = obj[&#8216;name&#8217;]<br />
            return self.user_name
<h3> freerr.php</h3>
<pre class="brush:php">&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;?php
$code = $_GET["code"];
//！！！！！以下修改三处。client_id后面加上api_key，redirect_uri后加上php文件的url，client_secret后加上secret_key。
$url = "https://graph.renren.com/oauth/token?grant_type=authorization_code&amp;client_id=&amp;redirect_uri=&amp;client_secret=&amp;code=".$code;
$json = file_get_contents($url);
?&gt;
&lt;textarea name="json"&gt;
&lt;?php
echo $json;
?&gt;
&lt;/textarea&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
&nbsp;</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">人間夜行</span></span>

      








  



<time datetime="2014-08-17T00:00:00+08:00" pubdate data-updated="true">Aug 17th, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/ji-suan-ji-ji-zhu/'>计算机技术</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="https://koccn.net/blog/%E4%BA%BA%E4%BA%BA%E7%BD%91linux%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%A2%84%E8%A7%88%E7%89%88%EF%BC%88%E5%81%9C%E5%B7%A5%EF%BC%89/" data-via="" data-counturl="https://koccn.net/blog/%E4%BA%BA%E4%BA%BA%E7%BD%91linux%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%A2%84%E8%A7%88%E7%89%88%EF%BC%88%E5%81%9C%E5%B7%A5%EF%BC%89/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/linux%E4%B8%8B%E4%BC%98%E9%85%B7%E8%A7%86%E9%A2%91%E8%87%AA%E5%8A%A8%E4%B8%8B%E8%BD%BD%E8%84%9A%E6%9C%AC/" title="Previous Post: Linux下优酷视频自动下载脚本">&laquo; Linux下优酷视频自动下载脚本</a>
      
      
        <a class="basic-alignment right" href="/blog/python3%E5%BF%AB%E9%80%9F%E9%98%85%E8%AF%BB%E5%B7%A5%E5%85%B7/" title="Next Post: Python3快速阅读工具">Python3快速阅读工具 &raquo;</a>
      
    </p>
  </footer>
</article>


  <section>
    <h1>Comments</h1>
    <div id="comments" aria-live="polite"><!-- Duoshuo Comment BEGIN -->
<div class="ds-thread" data-title="人人网Linux客户端预览版（停工）"></div>
<script type="text/javascript">
  var duoshuoQuery = {short_name:"koccn"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'https://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>
<!-- Duoshuo Comment END --></div>
  </section>

</div>

  <aside class="sidebar">
   
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:koccn.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/%E6%83%B3%E7%9C%8B%E5%8F%AA%E6%9C%89%E6%88%91%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E5%9F%8E%E5%B8%82/">想看只有我不存在的城市</a>
      </li>
    
      <li class="post">
        <a href="/blog/%E8%AF%BB%E8%BF%87%E3%82%B7%E3%83%89%E3%83%8B%E3%82%A2%E3%81%AE%E9%A8%8E%E5%A3%AB-15/">读过シドニアの騎士 15</a>
      </li>
    
      <li class="post">
        <a href="/blog/%E8%AF%BB%E8%BF%87%E3%82%B7%E3%83%89%E3%83%8B%E3%82%A2%E3%81%AE%E9%A8%8E%E5%A3%AB-1/">读过シドニアの騎士 1</a>
      </li>
    
      <li class="post">
        <a href="/blog/%E7%9C%8B%E8%BF%87%E8%BF%BD%E9%80%90%E7%B9%81%E6%98%9F%E7%9A%84%E5%AD%A9%E5%AD%90/">看过追逐繁星的孩子</a>
      </li>
    
      <li class="post">
        <a href="/blog/%E7%9C%8B%E8%BF%87%E5%91%BD%E8%BF%90%E7%9F%B3%E4%B9%8B%E9%97%A8%E5%89%A7%E5%9C%BA%E7%89%88%EF%BC%9A%E8%B4%9F%E8%8D%B7%E9%A2%86%E5%9F%9F%E7%9A%84%E6%97%A2%E8%A7%86%E6%84%9F/">看过命运石之门剧场版：负荷领域的既视感</a>
      </li>
    
  </ul>
</section>




<section>
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- art -->
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-4233275739544541"
         data-ad-slot="2323760118"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</section>

  
</aside>



    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - 人間夜行 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



<script>
  $(document).ready(function() {  
  var stickyNavTop = $('nav').offset().top;  
    
  var stickyNav = function(){  
  var scrollTop = $(window).scrollTop();  
         
  if (scrollTop > stickyNavTop) {   
      $('nav').addClass('sticky');  
  } else {  
      $('nav').removeClass('sticky');   
  }  
  };  
    
  stickyNav();  
    
  $(window).scroll(function() {  
      stickyNav();  
  });  
  });  
</script>


</body>
</html>
