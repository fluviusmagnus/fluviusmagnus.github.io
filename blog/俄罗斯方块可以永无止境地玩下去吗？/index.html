
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="zh-CN"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>俄罗斯方块可以永无止境地玩下去吗？ - 人間夜行</title>
  <meta name="author" content="人間夜行">

  
  <meta name="description" content="近日，看到一同学玩俄罗斯方块持久不死，便与其讨论，得出只要程序不耍人就可以无限玩下去的结论。现在看来，貌似是被证实了。 原文《俄罗斯方块可以永无止境地玩下去吗？》http://www.cnbeta.com/articles/160207.htm
大家在玩俄罗斯方块的时候有没有想过这样一个问题： &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://elephantus.moe/blog/%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E5%8F%AF%E4%BB%A5%E6%B0%B8%E6%97%A0%E6%AD%A2%E5%A2%83%E5%9C%B0%E7%8E%A9%E4%B8%8B%E5%8E%BB%E5%90%97%EF%BC%9F">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="人間夜行" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.lug.ustc.edu.cn/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!-- Now disabled to boost loading speed in mainland China
<link href='https://fonts.lug.ustc.edu.cn/css?family=Noto+Serif:400,700' rel='stylesheet' type='text/css'>
<link href='https://fonts.lug.ustc.edu.cn/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
-->

<!--Google page ad
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-4233275739544541",
    enable_page_level_ads: true
  });
</script>
-->
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-27694942-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">人間夜行</a></h1>
  
    <h2>一切の有為の法　夢幻泡影の如し</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  
  
</ul>

<ul class="main-navigation">
  <li><a href="/">博客</a></li>
  <li><a href="/blog/archives/">所有文章</a></li>
  <li><a href="/work/">工作室</a></li>
  <li><a href="/history/">站点历史</a></li>
  <li><a href="/留言板/">留言板</a></li>
  <li><a href="/donate/">捐赠与致谢</a></li>
  <li><a href="/about/">关于</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">俄罗斯方块可以永无止境地玩下去吗？</h1>
    
    
      <p class="meta">
        








  



<time datetime="2011-10-30T00:00:00+08:00" pubdate data-updated="true">Oct 30th, 2011</time>
        
        
           | <a href="#comments">评论</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>近日，看到一同学玩俄罗斯方块持久不死，便与其讨论，得出只要程序不耍人就可以无限玩下去的结论。现在看来，貌似是被证实了。</p>

<p>原文《俄罗斯方块可以永无止境地玩下去吗？》<a href="http://www.cnbeta.com/articles/160207.htm">http://www.cnbeta.com/articles/160207.htm</a>
<blockquote>大家在玩俄罗斯方块的时候有没有想过这样一个问题：如果玩家足够牛B的话，是不是永远也不可能玩死？换句话说，假设你是万恶的游戏机，你打算害死你面前的玩家；你知道任意时刻游戏的状态，并可以有针对性地给出一些明显不合适的方块，尽量迫使玩家面对最坏情况。那么，你有没有一种算法能保证害死玩家，或者玩家无论如何都存在一种必胜策略呢？<!--more--></blockquote></p>

<p>注意，俄罗斯方块的游戏区域是一个宽为10，高为20的矩形，并且玩家可以预先看到下一个给出的方块是什么。在设计策略时，你必需考虑到这一点。</p>

<p><img src="http://www.koccn.net/wordpress/wp-content/uploads/auto_save_image/2011/10/045120qIp.png" alt="" border="0" /></p>

<p>相信很多人有过这样的经历：玩俄罗斯方块时一开局就给你一个“S”型方块，让完美主义者感到异常别扭；结果，第二个方块还是这个“S”，第三个方块依旧是“S”，相当令人崩溃。于是，我们开始猜测，如果游戏机给你无穷个“S”形方块，玩家是不是就没有解了？答案是否定的。如图1，从第10步开始，整个局面产生一个循环；只要机器给的一直都是“S”方块，玩家可以不断重复这几个步骤，保证永远也死不了。</p>

<p><img src="http://www.koccn.net/wordpress/wp-content/uploads/auto_save_image/2011/10/045120J67.png" alt="" border="0" /></p>

<p>不过，这个循环是在游戏场地清空了的情况下才产生的。有人会进一步想了，要是在玩着玩着，看着你局势不好时突然给你无穷多个“S”方块呢？事实上，此时局面的循环依然可能存在，如图2。在第5个“S”形方块落地后，循环再次产生。</p>

<p>俄罗斯方块真的不可能玩死吗？1988年，John Brzustowski的<a href="http://www.iam.ubc.ca/theses/Brzustowski/brzustowski.html" target="_blank">一篇论文</a>指出，俄罗斯方块游戏无解并非不可能。它给出了一种算法可以保证游戏机能够害死玩家，即使我们要求它必须提前向玩家展示出下一个方块的形状。构造的关键在于，整个游戏的局面个数是有限的（2的200次方），如果玩家一直不死，在某一时刻必然会重复某一状态。我们把两次重复状态及其之间的游戏过程叫做一个“循环”，这个循环实际影响到的那些行就叫做“实际循环区”。例如，图2就是一个循环，这个循环的“实际循环区”是从第4行到第7行这四行。</p>

<p><img src="http://www.koccn.net/wordpress/wp-content/uploads/auto_save_image/2011/10/045122lTf.png" alt="" border="0" /></p>

<p>我们把宽为10的游戏区域划分为5个宽为2的“通道”，从左至右用1到5标号。注意到图1和图2中的两个循环都有一个共同点：每个“S”形方块最终都完全落在某个通道内。事实上，对于任意一个只有“S”形方块的循环，我们都有这个结论。也就是说，如果游戏机一直给你“S”形的方块，你却用它们弄出了一个循环，那只有一种可能：所有“S”形方块的下落位置都没有跨越通道（就像图3中的紫色方块那样，而非绿色方块那样）。</p>

<p>为了证明这一点，我们对通道编号施归纳。令命题P(x)表示，如果某个“S”形方块（或它的其中一部分）落在了通道x的左边，那它一定完全落在某个通道内。P(1)显然成立：方块根本不可能占据通道1左边的某个格子，因为通道1左边啥都没有。下面我们说明，当P(n)为真时，P(n+1)也为真。</p>

<p><img src="http://www.koccn.net/wordpress/wp-content/uploads/auto_save_image/2011/10/045122CSC.png" alt="" border="0" /></p>

<p>我们首先要证明一个引理：在循环中的任意时刻，通道n的实际循环区内绝对不可能出现形如“口■”的两个并排的格子。如图4.1，假设图中星号方块所在行是通道n的实际循环区内位置最低的“口■”的结构。假如这一行被消掉了，又由归纳假设，不存在哪个“S”形方块跨越了该通道的左边界，因此只有一种可能：某个“S”形方块从左侧面挤了进来（如图4.2）。但这样一来，我们又产生了一个更低的“口■”，矛盾。这就是说，星号方块所在行一直没被消去。但这也是不可能的，因为实际循环区内是一个新陈代谢、以旧换新的更替过程，每一行最后都是会被消除的。</p>

<p><img src="http://www.koccn.net/wordpress/wp-content/uploads/auto_save_image/2011/10/045122QB1.png" alt="" border="0" /></p>

<p>接下来，考虑命题P(n+1)。要想让“S”形方块占据通道n的格子，只有图5这四种情况。但是，由于我们之前证明了通道n中不能存在“口■”，因此在这个“S”形方块落下之前，星号方块都是已经有了的了。注意到，每一个“S”形方块的下落都致使“■口”形结构的减少，但第一种情形除外——它消除了一个“■口”形结构，但在其上方带来了一个新的，使得“■口”形结构个数保持不变。没有哪种情形能够增加“■口”的个数。但是，通道n的“■口”形结构个数应该是恒定的，因为它在一个循环区里。因此，只有第一种情况才能够被接受。</p>

<p>因此，仅含有“S”形方块的循环只有一种情况——“S”形方块在各个通道内重叠，填满并消除若干行后回到初始状态。实际循环区内的每个通道都是一个模样：底下是0个或多个“■■”，顶部一个“■口”。注意，最右侧那个通道的最顶端是一个“■口”，右边这个空白一辈子也不可能用“Z”形方块填上。也就是说，在一个只含“S”形方块的循环区内，必然会有某一行，它的最右侧是一个“■口”，它保证了该行不能仅用“Z”形方块消掉。如图6所示，箭头所指的行无法单用“Z”形方块消除，因为星号位置不可能用“Z”形方块填充。</p>

<p><img src="http://www.koccn.net/wordpress/wp-content/uploads/auto_save_image/2011/10/045122l3m.png" alt="" border="0" /></p>

<p>下面我们给出游戏机害死人的算法：<br />
1. 不断给出“S”形方块并显示下一个方块也为“S”，直到出现一个循环；<br />
2. 给一个“S”形方块并显示下一个方块为“Z”；<br />
3. 不断给出“Z”形方块并显示下一个方块也为“Z”，直到出现一个循环；<br />
4. 给一个“Z”形方块并显示下一个方块为“S”；<br />
5. 跳回1并重复执行。</p>

<p><img src="http://www.koccn.net/wordpress/wp-content/uploads/auto_save_image/2011/10/045122Lhu.png" alt="" border="0" /></p>

<p>这样的话，玩家为什么会无解呢？由上面的结论，在第1步后，游戏区域中出现了一个不能用“Z”消除的行。即使再给你一个“S”形方块，这一点仍然无法挽救，因为填充星号空格的唯一途径就是插一个“S”进去，但这立即又产生了一个“Z”永远放不进去的空位。然后，玩家就拿到了一大堆“Z”，最终必然会产生另一个循环，且这个循环区在刚才那个无法消去的行之上（循环区不可能包含一个不能消除的行，因为正如前面所说，一个实际循环区的所有行最终都是会被消掉的，这样才可能循环）。这个循环区的最左边那个通道将会产生一个“口■”结构，是“S”所不能消去的。于是，游戏机又给出一大堆的“S”，最终使得两种无法消去的行交替出现，直至Game Over。</p>

<p>有两点值得注意。一、虽然我们这里假设游戏机是有主观能动性的，但事实上呢，即使方块是随机出的，如果你足够倒霉的话，这个特殊的方块序列可能恰好就让你一个不错地碰上了；虽然这种怪事的发生概率极低，但理论上说仍然是可能的，因此俄罗斯方块终究不是玩不死的，总有一个时候会Game Over。二、这个结论可以直接扩展到场地为任意宽度的俄罗斯方块游戏。当场地宽为偶数时，上述证明同样有效；当场地宽为奇数时，无穷多个方形方块就可以直接干掉玩家。</p>

<p>文/matrix67.com
果然，编写一个整人的俄罗斯方块还是很有意思的。</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">作者 <span class="fn">人間夜行</span></span>

      








  



<time datetime="2011-10-30T00:00:00+08:00" pubdate data-updated="true">Oct 30th, 2011</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/zhuan-fa-ji-bei-wang/'>转发及备忘</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/cygwin%E4%B8%AD%E4%B8%8A%E4%BA%BA%E4%BA%BA/" title="上一篇：Cygwin中上人人">&laquo; Cygwin中上人人</a>
      
      
        <a class="basic-alignment right" href="/blog/prolog%E8%AF%AD%E8%A8%80%E4%B8%80%E7%9E%A5/" title="下一篇：Prolog语言一瞥">Prolog语言一瞥 &raquo;</a>
      
    </p>
  </footer>
</article>


  <section>
    <h1>评论</h1>
    <div id="comments" aria-live="polite"><!-- Duoshuo Comment BEGIN -->
<div class="ds-thread" data-title="俄罗斯方块可以永无止境地玩下去吗？"></div>
<script type="text/javascript">
  var duoshuoQuery = {short_name:"koccn"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'https://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>
<!-- Duoshuo Comment END --></div>
  </section>

</div>

  <aside class="sidebar">
   
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <!-- original line is unavailable
    <input type="hidden" name="q" value="site:elephantus.moe" />
    -->
    <input type="hidden" name="sitesearch" value="elephantus.moe" />
    <input class="search" type="text" name="q" results="0" placeholder="搜索"/>
  </fieldset>
</form>
  
  
    <section>
    <h1>捐赠与致谢</h1>
    <a href="/donate/"><img src="https://o2guqap13.qnssl.com/donate_page.jpg" /></a>
</section>
<section>
  <h1>最新文章</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/methodology-of-an-ordinary-linux-user/">普通 Linux 用户的方法论</a>
      </li>
    
      <li class="post">
        <a href="/blog/comments-on-three-science-fictions/">幻评三篇</a>
      </li>
    
      <li class="post">
        <a href="/blog/%E7%9C%8B%E8%BF%87%E7%A6%8F%E9%9F%B3%E6%88%98%E5%A3%AB%E6%96%B0%E5%89%A7%E5%9C%BA%E7%89%88%EF%BC%9Aq/">看过福音战士新剧场版：Q</a>
      </li>
    
      <li class="post">
        <a href="/blog/%E7%94%A8%E8%BF%87%E7%BA%AA%E5%BF%B5%E7%A2%91%E8%B0%B7-(iphone-ipad)/">用过纪念碑谷 (iPhone / iPad)</a>
      </li>
    
      <li class="post">
        <a href="/blog/%E7%8E%A9%E8%BF%87the-swords-%E8%AF%B4%E5%89%91/">玩过the Swords 说剑</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>文章分类</h1>
    <ul id="category-list"><li><a href='/blog/categories/acdai-ma/'>ac代码 (35)</a></li><li><a href='/blog/categories/ge-ren-ri-ji/'>个人日记 (75)</a></li><li><a href='/blog/categories/huan-xiang/'>幻想 (3)</a></li><li><a href='/blog/categories/wei-fen-lei/'>未分类 (9)</a></li><li><a href='/blog/categories/ji-suan-ji-ji-zhu/'>计算机技术 (52)</a></li><li><a href='/blog/categories/du-hou-gan/'>读后感 (24)</a></li><li><a href='/blog/categories/dou-ban-shou-cang/'>豆瓣收藏 (99)</a></li><li><a href='/blog/categories/zhuan-fa-ji-bei-wang/'>转发及备忘 (3)</a></li><li><a href='/blog/categories/bian-xue-bian-jiang/'>边学边讲 (8)</a></li></ul>
</section>
<section>
    <h1>推荐</h1>
    <p><a href="https://www.vultr.com/?ref=6858690"><img src="https://www.vultr.com/media/300x250_02.gif" width="300" height="250"><br />每月5美元，768MB内存，15GB SSD硬盘，千GB流量，含日本机房</a></p>
    <p><a href="https:&#x2F;&#x2F;www.namecheap.com&#x2F;?aff=96481"><img src="https:&#x2F;&#x2F;files.namecheap.com&#x2F;graphics&#x2F;linkus&#x2F;300x250-1.gif" width="300" height="250" border="0" alt="Namecheap.com"><br />多种低价域名，赠一年隐私保护</a></p>
</section>
<section>
    <h1>广告</h1>
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- art -->
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-4233275739544541"
         data-ad-slot="2323760118"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</section>
<section>
    <h1>友情链接</h1>
    <ul>
        <li><a href="http://www.archlinuxcn.org/">Archlinux中文论坛</a></li>
        <li><a href="http://sfiction.blog.163.com/">灰然如此</a> 某同学之私人 Blog</li>
        <li><a href="http://gndrive.org/">高达数字实验室</a> Eric 的小站</li>
        <li><a href="http://www.gaomezi.com/">搞么子</a> 质量原创</li>
        <li><a href="http://forum.ubuntu.org.cn/">Ubuntu中文论坛</a></li>
        <li><a href="/about/">申请加入</a> 请联系我</li>
    </ul>
</section>

  
</aside>



    </div>
  </div>
  <footer role="contentinfo"><p>
  本站所有作品除非特殊说明均采用 <strong><a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/" rel="license">知识共享署名-非商业性使用-相同方式共享 3.0 中国大陆许可协议</a></strong> 进行许可。<br />
  Copyright &copy; 2011-2017 - 人間夜行 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  









<script>
  $(document).ready(function() {  
  var stickyNavTop = $('nav').offset().top;  
    
  var stickyNav = function(){  
  var scrollTop = $(window).scrollTop();  
         
  if (scrollTop > stickyNavTop) {   
      $('nav').addClass('sticky');  
  } else {  
      $('nav').removeClass('sticky');   
  }  
  };  
    
  stickyNav();  
    
  $(window).scroll(function() {  
      stickyNav();  
  });  
  });  
</script>


</body>
</html>
