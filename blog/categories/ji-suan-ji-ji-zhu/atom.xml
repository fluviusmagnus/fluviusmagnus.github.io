<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: 计算机技术 | 人間夜行]]></title>
  <link href="https://elephantus.moe/blog/categories/ji-suan-ji-ji-zhu/atom.xml" rel="self"/>
  <link href="https://elephantus.moe/"/>
  <updated>2016-03-10T20:21:19+08:00</updated>
  <id>https://elephantus.moe/</id>
  <author>
    <name><![CDATA[人間夜行]]></name>
    <email><![CDATA[ich@elephantus.moe]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[出于某些原因移动了站点]]></title>
    <link href="https://elephantus.moe/blog/moved-the-site-to-somewhere-else/"/>
    <updated>2016-03-10T19:53:02+08:00</updated>
    <id>https://elephantus.moe/blog/moved-the-site-to-somewhere-else</id>
    <content type="html"><![CDATA[<p>之前提到过，作为静态页面的本站是由 GitHub Pages 提供托管服务的。这样做的好处很明显，可以节省自己维护的成本，但劣势也同样存在。</p>

<p>今天偶然发现，百度无论如何都无法收录我的新版站点，经调查，乃是 GitHub 阻止百度爬虫之故。为了避免访问量的损失，以及获得自己个性化配置站点功能的条件，我决定把网站放到自己一台独立的机器上。虽然会加速消耗一定的流量，但好在基本都是静态页面，而且有 CDN 的帮助，应该能减少相当一部分负担。<!--more--></p>

<p>自然，我们要使用优雅的方式（虽然还是很蠢），Github Webhooks 的功能得以使用。除了 Github 的一个奇怪之处（或许以后有机会再介绍），基本上整个流程写下来还是顺利的。唯独困扰我许久的问题竟然是一个权限问题，暂且在此记录下来。</p>

<p>我喜欢 Python，所以用它来写 CGI，中间打算调用一下 <code>git pull</code>，然而每次都报错。通过 <code>os.system()</code> 得到的退出码是 256。一般情况，退出码的范围是 0~255，这个 256 就很奇怪，后来发现这是由 Python 特别转换过得到的，对应的实际退出码是 1。这样便明确了错误原因是没有权限。我们（我当时不）知道，网页服务器的权限是很低的，所以要把相应要处理的文件的组设置为 <code>www-data</code> 并给足权限才可以使用。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[导入豆瓣 RSS 至 Octopress]]></title>
    <link href="https://elephantus.moe/blog/import-douban-rss-into-octopress/"/>
    <updated>2016-02-14T14:14:30+08:00</updated>
    <id>https://elephantus.moe/blog/import-douban-rss-into-octopress</id>
    <content type="html"><![CDATA[<p>大家也许已经熟悉了本站最近的运作风格，即发表的文章中有许多来自我在 <a href="http://www.douban.com/people/elephantus/">豆瓣</a> 上的短评。之前在使用 WordPress 的时候，我使用了一个插件来导入 RSS 文件，虽然能用，但是并不稳定。<!-- more --></p>

<p>如今我使用了 Octopress，这就意味着如果还要做这样一件事，就必须自己动手写一些东西了。非常幸运，这件事情可以还原为<strong>从 RSS 迁移博客</strong>，简单搜索便得到了 <a href="http://import.jekyllrb.com/docs/rss/">官方指南</a>。由于避免重复劳动是美德，我便写了如下脚本放在 Octopress 目录下新建的 <code>douban</code> 文件夹中。</p>

<p>使用前除了注意脚本位置外，还应更改你所需的 URL 等信息，另外如果是第一次使用，可能还需要运行 <code>gem install jekyll-import</code> 安装相应依赖。</p>

<hr />

<p>2016-02-22 更新</p>

<p>被友人刺激，我下决心改善一下本站 https 崩掉的情况。除了那个令人束手无策的评论框，想来大概也就是豆瓣的问题。本想做个查找替换，却无意间发现 RSS 文件本身如果用 https 调用，则里面的资源也都会相应改变。这下只要稍作修改，便一劳永逸。当然以前发布了的还是要手动改。</p>

<p>仔细看发现 http 版的 RSS 中豆瓣的图片资源有两类位置，其一类似于 <code>imgX.douban.com</code>，其二 <code>imgX.doubanio.com</code>，<code>X</code> 是一个数字。其中后者可以直接支持 https。而在 https 版的 RSS 中，所有资源都是后者形式。图片文件名虽然相同，但服务器的对应关系（主要是那个数字）我尚不明确，欢迎各位讨论。我觉得说不定豆瓣也要开始做全站 https 化了呢。</p>

<p>总之，下方代码也作出更新。</p>

<p><div class="highlight"><pre><code class="language-bash" data-lang="bash">&lt;/p&gt;

&lt;h1&gt;!/bin/bash&lt;/h1&gt;

&lt;h1&gt;get_douban.sh&lt;/h1&gt;

&lt;p&gt;#&lt;/p&gt;

&lt;h1&gt;This script gets <span class="m">10</span> latest items in your collection in douban.com via its RSS file offered, and converts them to octopress posts.&lt;/h1&gt;

&lt;h1&gt;This script works in a subdirectory <span class="o">(</span>you can create a new one<span class="o">)</span> which has the same position as the directory <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="nb">source</span><span class="p">&amp;</span>rsquo<span class="p">;</span>.&lt;/h1&gt;

&lt;h1&gt;Before you run this, make sure that <span class="p">&amp;</span>lsquo<span class="p">;</span>jekyll-import<span class="p">&amp;</span>rsquo<span class="p">;</span> is installed by gem.&lt;/h1&gt;

&lt;h1&gt;You must change the URL below to your own feed. You can also customize the category name.&lt;/h1&gt;

&lt;h1&gt;Change the URL below!&lt;/h1&gt;

&lt;p&gt;wget &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://www.douban.com/feed/people/elephantus/interests&quot;</span>&gt;https://www.douban.com/feed/people/elephantus/interests&lt;/a&gt; -O douban.xml&lt;/p&gt;

&lt;p&gt;ruby -rubygems -e <span class="p">&amp;</span>lsquo<span class="p">;</span>require <span class="p">&amp;</span>ldquo<span class="p">;</span>jekyll-import<span class="p">&amp;</span>rdquo<span class="p">;;</span>
    JekyllImport::Importers::RSS.run<span class="o">({</span>
      <span class="p">&amp;</span>ldquo<span class="p">;</span><span class="nb">source</span><span class="p">&amp;</span>rdquo<span class="p">;</span> <span class="o">=</span>&gt; <span class="p">&amp;</span>ldquo<span class="p">;</span>douban.xml<span class="p">&amp;</span>rdquo<span class="p">;</span>
    <span class="o">})</span><span class="p">&amp;</span>rsquo<span class="p">;</span>&lt;/p&gt;

&lt;p&gt;for f in ./_posts/*
<span class="k">do</span>
    <span class="c"># Maybe change this line. Check &amp;lsquo;man sed&amp;rsquo; to know more about this.</span>
    sed -i <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="m">3</span> acategories:<span class="se">\n</span>-<span class="se">\ </span>豆瓣收藏<span class="se">\n</span>published:<span class="se">\ </span><span class="nb">true</span><span class="se">\n</span>comments:<span class="se">\ </span><span class="nb">true</span><span class="p">&amp;</span>rsquo<span class="p">;</span> <span class="nv">$f</span>
<span class="k">done</span>&lt;/p&gt;

&lt;p&gt;mv -nv ./&lt;em&gt;posts/* ../source/&lt;/em&gt;posts/
rm ./_posts/*</code></pre></div></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ubuntu连接北外新版无线网教程]]></title>
    <link href="https://elephantus.moe/blog/ubuntu%E8%BF%9E%E6%8E%A5%E5%8C%97%E5%A4%96%E6%96%B0%E7%89%88%E6%97%A0%E7%BA%BF%E7%BD%91%E6%95%99%E7%A8%8B/"/>
    <updated>2015-11-17T00:00:00+08:00</updated>
    <id>https://elephantus.moe/blog/ubuntu连接北外新版无线网教程</id>
    <content type="html"><![CDATA[<p>2015年11月，我们学校（北京外国语大学）在全校范围内更新了一整套无线网系统，从此告别无加密的危险网络。</p>




<p>原来的认证方式是经典的连接后通过网页确认用户名密码的两步认证设计。这一设计在校内经常断线的环境下体验不佳，经常用到一半就需要判断是否需要断开重连，或者开个任意网页重新认证。为避免麻烦，许多人选择了有线并加装路由器的方式。这种方式固然有其额外的好处，但晚上断电后便无法使用。一种新的方式实际上还是需要的。<!--more--></p>




<p>新版的无线网（指BFSU和BFSU Secure，BFSU Web仍然是原来网页认证方式）提供了wpa企业级加密，使用受保护的EAP（PEAP）认证方式，MSCHAPv2内部认证，其优越性不言而喻。虽然学校针对各个主要平台（Windows PC、Mac OS、iOS、Android）对于如何连接网络有着详细教程（因为似乎没有固定链接，所以详见数字北外），但是并没有Linux用户所需要的版本，而且事实上整个流程对于Linux用户而言并不是很友好。这种网络不能自动识别，因此需要手动配置。方法如图：</p>




<p><a href="http://koccn.net/wordpress/wp-content/uploads/2015/11/2015-11-17-212556屏幕截图.png"><img class="alignnone wp-image-1161 size-full" src="http://koccn.net/wordpress/wp-content/uploads/2015/11/2015-11-17-212556屏幕截图.png" alt="配置教程" width="480" height="518" /></a></p>




<p>主要应当确认“认证”以及“内部认证”，“匿名身份”为空，“用户名”“密码”就是曾经用于登录的帐号所用，证书的问题忽略即可。</p>




<p>然而问题是无线网信号还是很差。反正出门基本就不用无线了，室内就用路由器，日子照样好好过。</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[我的行为艺术]]></title>
    <link href="https://elephantus.moe/blog/%E6%88%91%E7%9A%84%E8%A1%8C%E4%B8%BA%E8%89%BA%E6%9C%AF/"/>
    <updated>2015-04-06T00:00:00+08:00</updated>
    <id>https://elephantus.moe/blog/我的行为艺术</id>
    <content type="html"><![CDATA[<p>我用假文制作了一个看似有内容的站点：<a title="人间夜行的行为艺术" href="http://art.koccn.net" target="_blank">人间夜行的行为艺术</a>。</p>




<p>大家可以通过<a title="人间夜行的行为艺术" href="http://art.koccn.net" target="_blank">art.koccn.net</a>或<a title="人间夜行的行为艺术" href="http://art.koccn.net" target="_blank">art.elephantus.tk</a>来访问。</p>




<p>其不能称内容的内容来源于 <a title="MoreText.js" href="http://more.handlino.com/?corpus=xuzhimo" target="_blank">MoreText.js: 一用就愛上的中文假文產生器</a>。当然，语料库还是徐志摩的比较好看。</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[万网虚拟主机Wordpress配置技巧]]></title>
    <link href="https://elephantus.moe/blog/%E4%B8%87%E7%BD%91%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BAwordpress%E9%85%8D%E7%BD%AE%E6%8A%80%E5%B7%A7/"/>
    <updated>2015-02-03T00:00:00+08:00</updated>
    <id>https://elephantus.moe/blog/万网虚拟主机wordpress配置技巧</id>
    <content type="html"><![CDATA[<p>众所周知，Wordpress如果运行不正常很可能是由于php的配置有误。本来只需要修改一下配置，但对于虚拟主机来说，这个问题确实相当棘手的。现在就来分享一下我目前遇到的两个问题及其解决办法。Wordpress版本4.1，从其他网站迁移过来的，php版本5.3.23。<!--more--></p>




<p>首先遇到的是登录问题，由于headers无法rewrite，wp就没法写cookies。这个问题的解决其实很简单，良心的万网在后台提供了打开输出缓冲区数据块的php设置项。只要启用，问题就解决。真是踏破铁鞋无觅处，得来全不费工夫。</p>




<p>另一个是邮件无法发送的问题。和国内大多数虚拟主机一样，php的邮件函数是被禁用的，所以只能考虑smtp。但是smtp试了一下还是不成功，WP Mail Bank等插件的返回是“smtp error failed to connect to server (0)”。这个问题我研究了很久，网上都没有直接的资料，最后终于发现是wp-includes/class-smtp.php出现问题。</p>




<p>通过<a title="fsockopen、pfsockopen函数被禁用导致WordPress无法SMTP发信解决方案" href="http://leo108.com/pid-1497.asp" target="_blank">《fsockopen、pfsockopen函数被禁用导致WordPress无法SMTP发信解决方案 | leo108's blog》</a>可以得知，要在fsockopen上动手脚才能解决问题。但是仔细一看，4.1的wp里已经默认使用了作为“解决方案”的stream_socket_client函数。此时，回到万网后台一看，发现fsockopen恰恰可以选择打开。于是打开后，抱着试试看的心态逆着wp开发者的想法把函数改了回去。如下：
<pre class="brush:php">        //$this-&gt;smtp_conn = @stream_socket_client(
        $this-&gt;smtp_conn = @fsockopen(
        //    $host . ":" . $port,
            $host, //added
            $port, //added
            $errno,
            $errstr,
            $timeout
        //    STREAM_CLIENT_CONNECT,
        //    $socket_context
        );</pre>
注释掉的为原来的部分。经测试成功。</p>




<p>如此奇怪的方法只能在这里记一下，免得到时候升级程序时又挂了。</p>




<p>PS：其实问题没有得到真正解决。Backupwp插件无法正常发送备份邮件。懒人只能选择换一个能用的插件。</p>

]]></content>
  </entry>
  
</feed>
